# 14、综合评价决策方法

## 14.1、TOPSIS法

​	多属性决策方案集为$D={d_1,d_2,...,d_m}$，衡量优劣的属性变量为$x_1,x_2,...,x_n$，每个决策d都有相应的向量表征方案。

​	假设最佳方案为$C^*$，最差方案为$C^0$，要选择尽可能靠近$C^*$，远离$C^0$的决策。

​	在属性空间定义距离测度就可以计算距离TOPSIS使用欧几里德距离。

```matlab
%ex14_1_3
clc, clear
a=[0.1	5	5000	4.7
 0.2	6	6000	5.6
 0.4	7	7000	6.7
 0.9	10	10000	2.3
 1.2	2	400	    1.8];
[m,n]=size(a);
x2=@(qujian,lb,ub,x)(1-(qujian(1)-x)./(qujian(1)-lb)).*(x>=lb & x<qujian(1))+(x>=qujian(1) & x<=qujian(2))+(1-(x-qujian(2))./(ub-qujian(2))).*(x>qujian(2) & x<=ub);
%设定最优区间和无法容忍的上下界
qujian=[5,6]; lb=2; ub=12;
a(:,2)=x2(qujian,lb,ub,a(:,2)); %对属性2进行变换
for j=1:n
    b(:,j)=a(:,j)/norm(a(:,j));  %向量规划化
end
%自行设定的权值
w=[0.2 0.3 0.4 0.1];
c=b.*repmat(w,m,1);      %求加权矩阵
%对成本型属性需要特别求一下
Cstar=max(c);    %求正理想解
Cstar(4)=min(c(:,4))  %属性4为成本型的
C0=min(c);       %q求负理想解
C0(4)=max(c(:,4))        %属性4为成本型的
for i=1:m
    Sstar(i)=norm(c(i,:)-Cstar);  %求到正理想解的距离
    S0(i)=norm(c(i,:)-C0);      %求到负理想的距离
end
f=S0./(Sstar+S0);
[sf,ind]=sort(f,'descend')       %求排序结果
```

	## 14.2、模糊综合评价

​	为了处理如人事考核这样的模糊问题

1. 确定因素集$U=\{u_1,u_2,...,u_n\}$，业绩，团队评价啥的；
2. 确定评语集$V=\{v_1,v_2,...,v_m\}$，好坏啥的；
3. 确定因素权重$A=[a_1,a_2,...,a_n]$，是一个模糊向量，和为1；
4. 确定模糊综合判断矩阵$R_{n*m}$，表示$U$到$V$的模糊关系矩阵；
5. 综合评判$B=AR$，得到$V$模糊向量；

### 多层次模糊综合评价

​	因素过多，权重难以分配；归一化条件也会让权重变得及其小。

1. 将因素集$U$分为子因素集$U_1、U_2、U_s$，作为对U的一个划分；
2. 对每个子因素集$U_i$做综合评判，得到一级评判向量$B_i$
3. 把每个$U_i$看作一个因素，对$K$做综合评判，得到二级评价向量$B$



​	其中一级评价向量需要每组内设计一个权重向量$A_i$，二级评价向量需要总共设计一个评价向量$A$。

## 14.3、数据包络分析

​	评价多个决策单元（DMU），处理多指标输入和多指标输出的问题。

### $C^2R$模型

​	设有n个DMU，每个DMU都有m种投入和s种产出；向量$X_i,Y_j$分别表示决策单元j的输入和输出向量；$v$和$u$分别表示输入输出权值向量。定义决策单元$j$的效率评价模型：

​	$h_j=(u^TY_j)/(v^TX_j)​$

​	需要求解大量的线性规划。

​	DEA特别适合具有多输入和多输出的系统：

1. DEA以决策单位各输入/输出的权重为变量；
2. 不必确定输入输出的关系；
3. 无需权重假设，具有很大客观性



​	DEA是一种以凸优化和线性规划为工具的评价方法，结构简单，操作方便。

## 14.4、灰色关联分析法

1. 确定m个比较对象，n个评价指标；
2. 确定各指标代表的权重，使用层次分析法确定权重；
3. 计算灰色关联系数，涉及一个分辨系数$\rho \in[0,1]$；
4. 计算灰色加权关联度$r_i$，表示第i个评价对象的；
5. 评价分析，排序；

```

```



## 14.5、主成分分析法